# 激光传感器WebUI使用说明

## 功能概述
新增的WebUI功能允许您通过浏览器实时查看所有激光传感器设备的状态，无需额外的监控软件。

## 主要特性
- **实时监控**: 通过WebSocket实时显示所有设备的输入状态
- **可视化界面**: 每个设备有36个输入通道，以网格形式直观展示
- **状态指示**: 红色表示触发状态，灰色表示正常状态
- **连接状态**: 显示WebSocket连接状态和最后更新时间

## 使用方法

### 1. 编译和上传
使用PlatformIO编译并上传代码到ESP32-S3设备：
```bash
pio run
pio run --target upload
```

### 2. 连接设备
确保ESP32-S3设备已连接到WiFi网络（LC_01），并获取IP地址。

### 3. 访问Web界面
打开浏览器，访问设备的IP地址：
```
http://[设备IP地址]
```
例如：`http://192.168.1.100`

### 4. 界面说明
- **设备卡片**: 每个设备显示为一个独立的卡片
- **输入通道**: 每个设备有36个输入通道，编号1-36
- **状态指示**: 
  - 🔴 红色圆点：检测到激光触发
  - ⚪ 灰色圆点：无触发状态
- **连接状态**: 显示与设备的WebSocket连接状态
- **更新时间**: 显示最后状态更新的时间

## 技术细节

### 通信协议
- **HTTP**: 用于提供Web页面和API接口
- **WebSocket**: 用于实时状态更新
- **Modbus RTU**: 用于与激光传感器设备通信

### API接口
- **GET /**: 获取主页面
- **GET /api/states**: 获取所有设备状态的JSON数据
- **WebSocket /ws**: 实时状态更新推送

### 状态数据格式
```json
{
  "device1": [
    {"id": 1, "state": 0},
    {"id": 2, "state": 1},
    ...
  ],
  "device2": [...],
  "device3": [...],
  "device4": [...]
}
```

## 故障排除

### 无法访问Web界面
1. 检查设备是否正确连接到WiFi
2. 确认设备IP地址是否正确
3. 检查防火墙设置

### 状态不更新
1. 检查WebSocket连接状态
2. 刷新页面重新连接
3. 检查设备串口输出是否有错误信息

### 设备通信问题
1. 检查RS485连接线路
2. 确认设备地址配置正确
3. 检查波特率设置（9600）

## 系统要求
- 支持HTML5的现代浏览器
- 与ESP32-S3设备在同一网络中
- 无需安装额外软件或插件

## 兼容性
- 支持PC和移动设备浏览器
- 响应式设计，适配不同屏幕尺寸
- 支持实时更新，无需手动刷新